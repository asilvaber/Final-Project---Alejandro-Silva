<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T28U3">Amplitude1FR</span>,<span class="var type1" id="S3T28U4">Amplitude2FR</span>,<span class="var type1" id="S4T28U5">A1amplitudeFR</span>,<span class="var type1" id="S5T28U6">A2amplitudeFR</span>,<span class="var type1" id="S6T28U7">B1amplitudeFR</span>,<span class="var type1" id="S7T28U8">B2amplitudeFR</span>,<span class="var type1" id="S8T15U9">W</span>] = NewtonRaphsonFR2dof(<span class="var type1" id="S9T1U12">tol</span>,<span class="var type1" id="S10T1U13">m1</span>,<span class="var type1" id="S11T1U14">m2</span>,<span class="var type1" id="S12T1U15">c1</span>,<span class="var type1" id="S13T1U16">c2</span>,<span class="var type1" id="S14T1U17">k1</span>,<span class="var type1" id="S15T1U18">k2</span>,<span class="var type1" id="S16T1U19">beta</span>,<span class="var type1" id="S17T1U20">fc11</span>,<span class="var type1" id="S18T1U21">fc12</span>,<span class="var type1" id="S19T1U22">fc21</span>,<span class="var type1" id="S20T1U23">fc22</span>,<span class="var type1" id="S21T1U24">fMin</span>,<span class="var type1" id="S22T1U25">fMax</span>,<span class="var type1" id="S23T1U26">numAmplSamples</span>,<span class="var type1" id="S24T1U27">numPulsSamples</span>,<span class="var type1" id="S25T1U28">aMax</span>,<span class="var type1" id="S26T1U29">maxIter</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T15:U26"><span class="var type1" id="S8T15U32">W</span> = <span class="mxinfo " id="T15:U28"><span class="mxinfo " id="T1:U29"><span class="mxinfo " id="T1:U30"><span class="var type1" id="S21T1U37">fMin</span>*<span class="mxinfo " id="T1:U32">2</span></span>*<span class="mxinfo " id="T1:U33">pi</span></span>:<span class="mxinfo " id="T1:U34"><span class="mxinfo " id="T1:U35">(<span class="mxinfo " id="T1:U36">(<span class="mxinfo " id="T1:U37"><span class="var type1" id="S22T1U47">fMax</span>-<span class="var type1" id="S21T1U48">fMin</span></span>)/(<span class="mxinfo " id="T1:U40"><span class="var type1" id="S24T1U51">numPulsSamples</span>-<span class="mxinfo " id="T1:U42">1</span></span>)</span>)*<span class="mxinfo " id="T1:U43">2</span></span>*<span class="mxinfo " id="T1:U44">pi</span></span>:<span class="mxinfo " id="T1:U45"><span class="mxinfo " id="T1:U46"><span class="var type1" id="S22T1U58">fMax</span>*<span class="mxinfo " id="T1:U48">2</span></span>*<span class="mxinfo " id="T1:U49">pi</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T28:U50"><span class="var type1" id="S2T28U64">Amplitude1FR</span> = <span class="mxinfo " id="T28:U52">zeros(<span class="var type1" id="S23T1U67">numAmplSamples</span>,<span class="mxinfo " id="T1:U54">length(<span class="var type1" id="S8T15U70">W</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T28:U56"><span class="var type1" id="S3T28U73">Amplitude2FR</span> = <span class="mxinfo " id="T28:U58">zeros(<span class="var type1" id="S23T1U76">numAmplSamples</span>,<span class="mxinfo " id="T1:U60">length(<span class="var type1" id="S8T15U79">W</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T28:U62"><span class="var type1" id="S4T28U82">A1amplitudeFR</span> = <span class="mxinfo " id="T28:U64">zeros(<span class="var type1" id="S23T1U85">numAmplSamples</span>,<span class="mxinfo " id="T1:U66">length(<span class="var type1" id="S8T15U88">W</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T28:U68"><span class="var type1" id="S6T28U91">B1amplitudeFR</span> = <span class="mxinfo " id="T28:U70">zeros(<span class="var type1" id="S23T1U94">numAmplSamples</span>,<span class="mxinfo " id="T1:U72">length(<span class="var type1" id="S8T15U97">W</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T28:U74"><span class="var type1" id="S5T28U100">A2amplitudeFR</span> = <span class="mxinfo " id="T28:U76">zeros(<span class="var type1" id="S23T1U103">numAmplSamples</span>,<span class="mxinfo " id="T1:U78">length(<span class="var type1" id="S8T15U106">W</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T28:U80"><span class="var type1" id="S7T28U109">B2amplitudeFR</span> = <span class="mxinfo " id="T28:U82">zeros(<span class="var type1" id="S23T1U112">numAmplSamples</span>,<span class="mxinfo " id="T1:U84">length(<span class="var type1" id="S8T15U115">W</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S30T1U118">i</span>=<span class="mxinfo " id="T1:U87">1</span>:<span class="mxinfo " id="T1:U88">length(<span class="var type1" id="S8T15U123">W</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S31T1U126">j</span>=<span class="mxinfo " id="T1:U91">1</span>:<span class="var type1" id="S23T1U129">numAmplSamples</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">        <span class="mxinfo " id="T1:U93"><span class="var type1" id="S32T1U132">n</span> = <span class="mxinfo " id="T1:U95">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">        <span class="mxinfo " id="T16:U96"><span class="var type1" id="S33T16U136">amplitude1</span> = <span class="mxinfo " id="T16:U98">[<span class="mxinfo " id="T1:U99"><span class="mxinfo " id="T1:U100"><span class="var type1" id="S31T1U141">j</span>*<span class="var type1" id="S25T1U142">aMax</span></span>/<span class="var type1" id="S23T1U143">numAmplSamples</span></span>; <span class="mxinfo " id="T1:U104"><span class="mxinfo " id="T1:U105"><span class="mxinfo " id="T1:U106">-<span class="var type1" id="S31T1U148">j</span></span>*<span class="var type1" id="S25T1U149">aMax</span></span>/<span class="var type1" id="S23T1U150">numAmplSamples</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">        <span class="mxinfo " id="T16:U110"><span class="var type1" id="S34T16U153">amplitude2</span> = <span class="mxinfo " id="T16:U112">[<span class="mxinfo " id="T1:U113"><span class="mxinfo " id="T1:U114"><span class="mxinfo " id="T1:U115">-<span class="var type1" id="S31T1U159">j</span></span>*<span class="var type1" id="S25T1U160">aMax</span></span>/<span class="var type1" id="S23T1U161">numAmplSamples</span></span>; <span class="mxinfo " id="T1:U119"><span class="mxinfo " id="T1:U120"><span class="var type1" id="S31T1U165">j</span>*<span class="var type1" id="S25T1U166">aMax</span></span>/<span class="var type1" id="S23T1U167">numAmplSamples</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">        <span class="mxinfo " id="T17:U124"><span class="var type1" id="S35T17U170">F</span> = <span class="mxinfo " id="T17:U126"><span class="fcn" id="F89N2:B172">FReq2dof</span>(<span class="var type1" id="S10T1U173">m1</span>,<span class="var type1" id="S11T1U174">m2</span>,<span class="var type1" id="S12T1U175">c1</span>,<span class="var type1" id="S13T1U176">c2</span>,<span class="var type1" id="S14T1U177">k1</span>,<span class="var type1" id="S15T1U178">k2</span>,<span class="var type1" id="S16T1U179">beta</span>,<span class="var type1" id="S17T1U180">fc11</span>,<span class="var type1" id="S18T1U181">fc12</span>,<span class="var type1" id="S19T1U182">fc21</span>,<span class="var type1" id="S20T1U183">fc22</span>,<span class="mxinfo " id="T1:U138"><span class="var type1" id="S8T15U185">W</span>(<span class="var type1" id="S30T1U186">i</span>)</span>,<span class="mxinfo " id="T1:U141"><span class="var type1" id="S33T16U188">amplitude1</span>(1)</span>,<span class="mxinfo " id="T1:U143"><span class="var type1" id="S33T16U191">amplitude1</span>(2)</span>,<span class="mxinfo " id="T1:U145"><span class="var type1" id="S34T16U194">amplitude2</span>(1)</span>,<span class="mxinfo " id="T1:U147"><span class="var type1" id="S34T16U197">amplitude2</span>(2)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">        <span class="keyword">while</span> <span class="mxinfo " id="T2:U149"><span class="mxinfo " id="T1:U150">norm(<span class="var type1" id="S35T17U204">F</span>)</span>&gt;<span class="var type1" id="S9T1U205">tol</span></span> &amp;&amp; <span class="mxinfo " id="T2:U153"><span class="var type1" id="S32T1U207">n</span>&lt;=<span class="var type1" id="S26T1U208">maxIter</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">            <span class="mxinfo " id="T17:U156"><span class="var type1" id="S35T17U211">F</span> = <span class="mxinfo " id="T17:U158"><span class="fcn" id="F89N2:B213">FReq2dof</span>(<span class="var type1" id="S10T1U214">m1</span>,<span class="var type1" id="S11T1U215">m2</span>,<span class="var type1" id="S12T1U216">c1</span>,<span class="var type1" id="S13T1U217">c2</span>,<span class="var type1" id="S14T1U218">k1</span>,<span class="var type1" id="S15T1U219">k2</span>,<span class="var type1" id="S16T1U220">beta</span>,<span class="var type1" id="S17T1U221">fc11</span>,<span class="var type1" id="S18T1U222">fc12</span>,<span class="var type1" id="S19T1U223">fc21</span>,<span class="var type1" id="S20T1U224">fc22</span>,<span class="mxinfo " id="T1:U170"><span class="var type1" id="S8T15U226">W</span>(<span class="var type1" id="S30T1U227">i</span>)</span>,<span class="mxinfo " id="T1:U173"><span class="var type1" id="S33T16U229">amplitude1</span>(1)</span>,<span class="mxinfo " id="T1:U175"><span class="var type1" id="S33T16U232">amplitude1</span>(2)</span>,<span class="mxinfo " id="T1:U177"><span class="var type1" id="S34T16U235">amplitude2</span>(1)</span>,<span class="mxinfo " id="T1:U179"><span class="var type1" id="S34T16U238">amplitude2</span>(2)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">            <span class="mxinfo " id="T20:U181"><span class="var type1" id="S38T20U242">J</span> = <span class="mxinfo " id="T20:U183"><span class="fcn" id="F107N3:B244">FRjac2dof</span>(<span class="var type1" id="S10T1U245">m1</span>,<span class="var type1" id="S11T1U246">m2</span>,<span class="var type1" id="S12T1U247">c1</span>,<span class="var type1" id="S13T1U248">c2</span>,<span class="var type1" id="S14T1U249">k1</span>,<span class="var type1" id="S15T1U250">k2</span>,<span class="var type1" id="S16T1U251">beta</span>,<span class="mxinfo " id="T1:U191"><span class="var type1" id="S8T15U253">W</span>(<span class="var type1" id="S30T1U254">i</span>)</span>,<span class="mxinfo " id="T1:U194"><span class="var type1" id="S33T16U256">amplitude1</span>(1)</span>,<span class="mxinfo " id="T1:U196"><span class="var type1" id="S33T16U259">amplitude1</span>(2)</span>,<span class="mxinfo " id="T1:U198"><span class="var type1" id="S34T16U262">amplitude2</span>(1)</span>,<span class="mxinfo " id="T1:U200"><span class="var type1" id="S34T16U265">amplitude2</span>(2)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">            <span class="mxinfo " id="T17:U202"><span class="var type1" id="S40T17U269">delta</span> = <span class="mxinfo " id="T17:U204"><span class="mxinfo " id="T20:U205">-<span class="var type1" id="S38T20U272">J</span></span>\<span class="var type1" id="S35T17U273">F</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">            <span class="mxinfo " id="T16:U208"><span class="var type1" id="S33T16U276">amplitude1</span> = <span class="mxinfo " id="T16:U210"><span class="var type1" id="S33T16U278">amplitude1</span> + <span class="mxinfo " id="T16:U212"><span class="var type1" id="S40T17U280">delta</span>(<span class="mxinfo " id="T29:U214"><span class="mxinfo " id="T1:U215">1</span>:<span class="mxinfo " id="T1:U216">2</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">            <span class="mxinfo " id="T16:U217"><span class="var type1" id="S34T16U286">amplitude2</span> = <span class="mxinfo " id="T16:U219"><span class="var type1" id="S34T16U288">amplitude2</span> + <span class="mxinfo " id="T16:U221"><span class="var type1" id="S40T17U290">delta</span>(<span class="mxinfo " id="T29:U223"><span class="mxinfo " id="T1:U224">3</span>:<span class="mxinfo " id="T1:U225">4</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">            <span class="mxinfo " id="T1:U226"><span class="var type1" id="S32T1U296">n</span> = <span class="mxinfo " id="T1:U228"><span class="var type1" id="S32T1U298">n</span>+<span class="mxinfo " id="T1:U230">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T2:U231"><span class="var type1" id="S32T1U303">n</span>&lt;=<span class="var type1" id="S26T1U304">maxIter</span></span>,</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">            <span class="mxinfo " id="T1:U234"><span class="mxinfo " id="T1:U235"><span class="var type1" id="S4T28U308">A1amplitudeFR</span>(<span class="var type1" id="S31T1U309">j</span>,<span class="var type1" id="S30T1U310">i</span>)</span> = <span class="mxinfo " id="T1:U239"><span class="var type1" id="S33T16U312">amplitude1</span>(<span class="mxinfo " id="T1:U241">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">            <span class="mxinfo " id="T1:U242"><span class="mxinfo " id="T1:U243"><span class="var type1" id="S5T28U317">A2amplitudeFR</span>(<span class="var type1" id="S31T1U318">j</span>,<span class="var type1" id="S30T1U319">i</span>)</span> = <span class="mxinfo " id="T1:U247"><span class="var type1" id="S34T16U321">amplitude2</span>(<span class="mxinfo " id="T1:U249">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">            <span class="mxinfo " id="T1:U250"><span class="mxinfo " id="T1:U251"><span class="var type1" id="S6T28U326">B1amplitudeFR</span>(<span class="var type1" id="S31T1U327">j</span>,<span class="var type1" id="S30T1U328">i</span>)</span> = <span class="mxinfo " id="T1:U255"><span class="var type1" id="S33T16U330">amplitude1</span>(<span class="mxinfo " id="T1:U257">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">            <span class="mxinfo " id="T1:U258"><span class="mxinfo " id="T1:U259"><span class="var type1" id="S7T28U335">B2amplitudeFR</span>(<span class="var type1" id="S31T1U336">j</span>,<span class="var type1" id="S30T1U337">i</span>)</span> = <span class="mxinfo " id="T1:U263"><span class="var type1" id="S34T16U339">amplitude2</span>(<span class="mxinfo " id="T1:U265">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">            <span class="mxinfo " id="T1:U266"><span class="mxinfo " id="T1:U267"><span class="var type1" id="S2T28U344">Amplitude1FR</span>(<span class="var type1" id="S31T1U345">j</span>,<span class="var type1" id="S30T1U346">i</span>)</span> = <span class="mxinfo " id="T1:U271">sqrt(<span class="mxinfo " id="T1:U272"><span class="mxinfo " id="T1:U273"><span class="mxinfo " id="T1:U274"><span class="var type1" id="S33T16U352">amplitude1</span>(2)</span>^2</span>+<span class="mxinfo " id="T1:U276"><span class="mxinfo " id="T1:U277"><span class="var type1" id="S33T16U357">amplitude1</span>(1)</span>^2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line">            <span class="mxinfo " id="T1:U279"><span class="mxinfo " id="T1:U280"><span class="var type1" id="S3T28U363">Amplitude2FR</span>(<span class="var type1" id="S31T1U364">j</span>,<span class="var type1" id="S30T1U365">i</span>)</span> = <span class="mxinfo " id="T1:U284">sqrt(<span class="mxinfo " id="T1:U285"><span class="mxinfo " id="T1:U286"><span class="mxinfo " id="T1:U287"><span class="var type1" id="S34T16U371">amplitude2</span>(2)</span>^2</span>+<span class="mxinfo " id="T1:U289"><span class="mxinfo " id="T1:U290"><span class="var type1" id="S34T16U376">amplitude2</span>(1)</span>^2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
